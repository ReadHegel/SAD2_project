---
title: "sad"
author: "Marcin Stopka, Franciszek Sobota, Grzegorz Dolanowski"
date: "2026-01-10"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#install.packages("here")
#install.packages("ggplot2")
#install.packages("dplyr")
#install.packages("fastDummies")


library(here)
library(ggplot2)
library(dplyr)
library(GGally)
library(fastDummies)
library(knitr)

data <- read.csv(here("task1", "all_data.csv"))

```

# Effect of sampling frequency

We can see on the plots that if time between sampling increases, the results get worse.
```{r}
ggplot(data, aes(x=factor(freq), y=jaccard_result)) +
  geom_violin()
```

We can test if the correlation is negative and we get
```{r}
tst <- cor.test(data$freq, data$jaccard_result, method = "spearman")
tst
```
with low p-value of `r tst$p.value``.

# Graph Metrics

We can see that the two graph metrics are very similar on the following plot.
```{r}
ggplot(data, aes(x=jaccard_result, y=jaccard_weighted_result)) + geom_point()
```
they are even exactly the same most of the time
```{r}
mean(data$jaccard_result == data$jaccard_weighted_result)
```

# Achieved results

The achieved results aren't very good, the median is low.
```{r}
summary(data$jaccard_result)
```
We can see that a lot of that is due to the frequency.
```{r}
kable(data %>% group_by(freq) %>% summarise(med=median(jaccard_result)))
```
```{r}
ggplot(data, aes(x="", y=jaccard_result)) +
  geom_violin()
```


# Effect of number of variables

For some reason the results are best when using 7 variables.
```{r}
ggplot(data, aes(x=factor(var_num), y=jaccard_result)) +
  geom_violin()
```

but the correlation is test does not give anything conclusive
```{r}
cor.test(data$var_num, data$jaccard_result, method = "spearman")
```

# Effect of mode

First we can see that the synchronous data is much less resistant to infrequent probes.
```{r}
ggplot(data, aes(x=mode,y=steps,fill=jaccard_result)) + geom_tile() + facet_wrap(~freq)
```
The asynchronous can deal with it, but synchronous works very bad whenever sampling frequency is not 1.

We can see on the following plot that if the frequency is 1, then synchronous data gives generally better results with the given amount of data. It can be because with the same number of transitions more variables get changed.
```{r}
ggplot(data %>% filter(freq==1), aes(x=mode, y=jaccard_result)) +
  geom_violin()
```

If we divide the data by number of variables we can see that with frequency 1, every time the synchronous option is better and the more steps we have, the better.
```{r}
ggplot(data %>% filter(freq==1), aes(x=mode,y=steps,fill=jaccard_result)) + geom_tile() +
    facet_wrap(~var_num)
```

# Linear regression

If we fun linear regression with all the data, the results aren't very good. On the other hand, if we filter only by those results that have frequency 1, we get a high R squared.
```{r}
data_with_dummies <- dummy_cols(data) %>% filter(freq==1)
linear_model <- lm(jaccard_result ~
                      var_num + steps + numtraj + attper + mode_asynchronous + score_type_BDE,
                      data_with_dummies)
summary(linear_model)
```
